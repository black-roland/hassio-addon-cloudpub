# Документация для аддона CloudPub

## Настройка

### Получение токена

Токен можно получить в [панели управления CloudPub](https://cloudpub.ru/dashboard/). Скопируйте только сам токен, без команды `./clo set token ` в начале.

### Конфигурация аддона

Для настройки аддона укажите следующие параметры:

- **Токен**: Ваш авторизационный токен CloudPub.
- **Сервисы**: Список сервисов для публикации. Каждый сервис должен содержать:
  - **Тип**: Тип сервиса (например, `http`, `https`, `tcp`, `udp`, `rtsp`, `1c`).
  - **Локальный адрес**: Локальный адрес и порт сервиса (например, `homeassistant:8123`).
  - **Имя**: (Опционально) Имя сервиса для удобства.

Пример конфигурации:

```yaml
token: "ваш_токен_здесь"
services:
  - type: http
    local_addr: homeassistant:8123
    name: homeassistant
  - type: tcp
    local_addr: core-mosquitto:1883 # обратите внимание, используется порт без поддержки SSL
    name: mqtt
```

### Конфигурация Home Assistant

Поскольку Home Assistant по умолчанию блокирует запросы от прокси-серверов, добавьте следующие строки в `configuration.yaml`, чтобы разрешить клиенту CloudPub доступ к вашему Home Assistant:

```yaml
http:
  use_x_forwarded_for: true
  trusted_proxies:
    - 172.30.33.0/24
```

После перезапустите Home Assistant, чтобы применить настройки.

## Использование

После настройки ваш Home Assistant будет доступен через публичный URL, предоставленный CloudPub. Ссылка доступна в журнале аддона. Управление туннелями и просмотр статистики доступны через [веб-интерфейс CloudPub](https://cloudpub.ru/dashboard/).
